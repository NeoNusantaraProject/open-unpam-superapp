---
import Layout from "../../../templates/layout.astro";
import Navbar from "../../../components/navbar.astro";
import { MaktulGroup } from "../../../components/presensi/matkul.tsx";

import { initAPI } from "../../../utilities/apiprovider";

const myUNPAMToken = Astro.cookies.get("my_unpam_token").value as string;
const presensiToken = Astro.cookies.get("presensi_token").value as string;
if (!presensiToken) return Astro.redirect("/dashboard");

const api = initAPI({ myUNPAMToken, presensiToken });

const { nama_user, id_user } = api.myunpam.getTokenPayloadDecoded();

// const matakuliah = await api.presensi.getJadwalKuliah();

// let errorMessage = "Hello World";
// let errorClass = "hidden";

// if (!matakuliah.status.success) {
//   errorClass = "visible";
//   errorMessage = matakuliah.status.message;
// }
---

<Layout pageName="Presensi">
  <Navbar username={nama_user} nim={id_user} />
  <div class="">
    <MaktulGroup astroCookie={{ myUNPAMToken, presensiToken }} client:visible />
  </div>
</Layout>
 ../../../components/presensi/matkul.tsx
